import{e as I,j as e,B as m,r as T,g as Q,u as ye,a as G,c as q,n as he,v as xe,w as pe,l as ve,T as re,F as ge,x as le,y as Ne,z as be,I as oe,A as ke,D as we,E as Y,G as Ce,H as Pe,M as Me,C as Se}from"./index-8k3NHg1O.js";import{D as Ae,a as De,b as Te,c as Fe,g as Le,d as $e,R as ne,H as Ie,T as Re,e as He,f as de}from"./dialog-CzfZG62x.js";import{C as P,a as M,b as S,c as A,d as D}from"./card-DHuo3zQd.js";import{F as _e,L as b,a as E,S as me}from"./label-CK7aOXpE.js";import{E as ue}from"./empty-state-CPOj4ARD.js";import{S as Z}from"./stat-line-CYdmxyro.js";import{C as ze}from"./clock-BksrT6E4.js";import{S as V,G as Oe}from"./section-collapse-DQfEbVie.js";import"./chevron-down-KnoLXRSR.js";const Ee=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],fe=I("award",Ee);const Ve=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],qe=I("chart-column",Ve);const Be=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],We=I("database",Be);const Ue=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ae=I("external-link",Ue);const Xe=[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]],Ge=I("gamepad-2",Xe);const Qe=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Je=I("graduation-cap",Qe);const Ke=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ye=I("minus",Ke);const Ze=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],es=I("palette",Ze);const ss=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],ts=I("trending-down",ss);const as=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ce=I("trending-up",as);const rs=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],ns=I("volume-2",rs);function je({open:c,onOpenChange:t,title:y,description:a,confirmLabel:k="Confirm",cancelLabel:g="Cancel",confirmVariant:F="default",onConfirm:N}){return e.jsx(Ae,{open:c,onOpenChange:t,children:e.jsxs(De,{className:"sm:max-w-md",children:[e.jsxs(Te,{children:[e.jsx(Fe,{children:y}),e.jsx(Le,{children:a})]}),e.jsxs($e,{className:"gap-2",children:[e.jsx(m,{variant:"outline",onClick:()=>t(!1),children:g}),e.jsx(m,{variant:F,onClick:()=>{N(),t(!1)},children:k})]})]})})}function cs({data:c,className:t}){const y=T.useId().replace(/:/g,""),a=T.useMemo(()=>c?c.filter(r=>Number.isFinite(r.accuracy)&&Number.isFinite(r.total)).map(r=>({...r,accuracy:Math.max(0,Math.min(100,Math.round(r.accuracy))),total:Math.max(0,Math.round(r.total))})):[],[c]);if(a.length===0){const r=[58,66,63,71,77].map((f,d)=>({x:12+d*18,y:44-f/100*30})),i=r.reduce((f,d,H)=>H===0?`M ${d.x} ${d.y}`:`${f} L ${d.x} ${d.y}`,"");return e.jsxs("div",{className:Q("rounded-xl border border-dashed border-border p-5",t),children:[e.jsx("div",{className:"relative h-28 rounded-lg bg-muted/30 p-3",children:e.jsxs("svg",{viewBox:"0 0 100 50",className:"h-full w-full",preserveAspectRatio:"none",children:[e.jsx("path",{d:`${i} L 84 46 L 12 46 Z`,fill:"hsl(var(--primary))",opacity:"0.08"}),e.jsx("path",{d:i,fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"1.5",strokeDasharray:"2 2",opacity:"0.45"}),r.map((f,d)=>e.jsx("circle",{cx:f.x,cy:f.y,r:"1.4",fill:"hsl(var(--primary))",opacity:"0.45"},d))]})}),e.jsx("div",{className:"mt-3 text-sm font-medium",children:"Your accuracy trend appears here after 3+ sessions"}),e.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:"Keep practicing consistently to unlock real progress insights."})]})}const k=Math.max(...a.map(r=>r.accuracy)),g=Math.min(...a.map(r=>r.accuracy)),F=Math.round(a.reduce((r,i)=>r+i.accuracy,0)/a.length);let N="flat";if(a.length>1){const r=a[0].accuracy,i=a[a.length-1].accuracy;i-r>2?N="up":r-i>2&&(N="down")}const R=100,L=50,u=5,h=a.map((r,i)=>{const f=a.length===1?R/2:i/(a.length-1)*(R-u*2)+u,d=L-u-r.accuracy/100*(L-u*2);return{x:f,y:d,accuracy:r.accuracy}}),w=h.reduce((r,i,f)=>{if(f===0)return`M ${i.x} ${i.y}`;const d=h[f-1],H=d.x+(i.x-d.x)/3,$=d.y,_=d.x+2*(i.x-d.x)/3,v=i.y;return`${r} C ${H} ${$}, ${_} ${v}, ${i.x} ${i.y}`},""),B=h.length>1?`${w} L ${h[h.length-1].x} ${L-u} L ${h[0].x} ${L-u} Z`:"",W=a.length>8?Math.ceil(a.length/8):1;return e.jsxs("div",{className:Q("space-y-4",t),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[F,"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Average accuracy"})]}),e.jsx("div",{className:"flex items-center gap-1 text-sm",children:N==="up"?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4 text-emerald-500"}),e.jsx("span",{className:"text-emerald-500 font-medium",children:"Improving"})]}):N==="down"?e.jsxs(e.Fragment,{children:[e.jsx(ts,{className:"w-4 h-4 text-rose-500"}),e.jsx("span",{className:"text-rose-500 font-medium",children:"Declining"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground font-medium",children:"Stable"})]})})]}),e.jsxs("div",{className:"text-right text-xs text-muted-foreground",children:[e.jsxs("div",{children:["High: ",k,"%"]}),e.jsxs("div",{children:["Low: ",g,"%"]})]})]}),e.jsxs("div",{className:"relative h-32 bg-muted/30 rounded-xl p-4 overflow-hidden",children:[e.jsxs("svg",{viewBox:`0 0 ${R} ${L}`,className:"w-full h-full",preserveAspectRatio:"none",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:y,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"hsl(var(--primary))",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"hsl(var(--primary))",stopOpacity:"0.05"})]})}),h.length>1&&e.jsx("path",{d:B,fill:`url(#${y})`}),h.length>1&&e.jsx("path",{d:w,fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"1.5",strokeLinecap:"round"}),h.map((r,i)=>e.jsx("circle",{cx:r.x,cy:r.y,r:"1.5",fill:"hsl(var(--primary))",className:"hover:r-3 transition-all"},i))]}),e.jsxs("div",{className:"absolute left-2 top-2 bottom-8 flex flex-col justify-between text-[10px] text-muted-foreground",children:[e.jsx("span",{children:"100%"}),e.jsx("span",{children:"50%"}),e.jsx("span",{children:"0%"})]})]}),e.jsx("div",{className:"flex justify-between px-4 text-xs text-muted-foreground",children:a.map((r,i)=>e.jsx("span",{className:i%W===0||i===a.length-1?"":"invisible",children:r.date},i))}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-1 rounded-full bg-primary"}),e.jsx("span",{children:"Accuracy trend"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary/20"}),e.jsx("span",{children:"Confidence zone"})]})]})]})}const is={first_note:re,streak_7:ge,streak_30:ze,perfect_session:fe,speed_demon:ce,explorer:re};function ls(){const c=ye(),{positionStats:t,heatMapEnabled:y,toggleHeatMap:a,resetHeatMap:k,totalPracticeTime:g,streakDays:F,streakFreezes:N,totalCorrect:R,totalIncorrect:L,achievements:u,getAccuracyForFretboard:h,sessionHistory:w}=G(),B=q(n=>n.full.instrument.leftHanded),W=q(n=>n.quick.tuning),r=T.useMemo(()=>he(W),[W]),i=xe(n=>n.enqueue),[f,d]=pe(),[H,$]=T.useState(!1),_=f.get("range"),v=_==="month"||_==="all"?_:"week",z=n=>{const o=new URLSearchParams(f);o.set("range",n),d(o,{replace:!0})},J=(n,o="info")=>{i(n,o)},x=T.useMemo(()=>{const n=R+L,o=n>0?Math.round(R/n*100):0,l=Object.keys(t).length,p=r.length*12,C=Math.round(l/p*100),X=Object.entries(t).filter(([,O])=>O.total>=3).sort((O,ie)=>O[1].correct/O[1].total-ie[1].correct/ie[1].total).slice(0,5);return{total:n,accuracy:o,positionsPracticed:l,coverage:C,weakPositions:X}},[t,R,L,r.length]),ee=T.useMemo(()=>y?h().filter(({accuracy:o})=>o!==null).map(({position:o,accuracy:l})=>({position:o,status:"idle",opacity:.3+(l||0)*.7})):[],[y,h]),se=T.useMemo(()=>x.positionsPracticed>0?[]:r.flatMap((n,o)=>Array.from({length:12},(l,p)=>({position:{stringIndex:o,fret:p+1,note:ve(n,p+1)},status:"idle",opacity:.1,color:"hsl(var(--muted-foreground) / 0.35)"}))),[x.positionsPracticed,r]),te=x.positionsPracticed===0?se:ee,s=u.filter(n=>n.unlockedAt),j=T.useMemo(()=>{const n=new Map;let o=null;if(v==="week"){const l=new Date;l.setDate(l.getDate()-6),o=l.toISOString().split("T")[0]}else if(v==="month"){const l=new Date;l.setDate(l.getDate()-29),o=l.toISOString().split("T")[0]}for(const l of w){const p=(l.endedAt||l.startedAt||new Date().toISOString()).split("T")[0];if(o&&p<o)continue;const C=n.get(p)||{correct:0,incorrect:0,total:0},X=l.correct||0,O=l.incorrect||0;n.set(p,{correct:C.correct+X,incorrect:C.incorrect+O,total:C.total+X+O})}return Array.from(n.entries()).sort(([l],[p])=>l.localeCompare(p)).map(([l,p])=>{const C=new Date(`${l}T00:00:00`);return{date:v==="week"?C.toLocaleDateString(void 0,{weekday:"short"}):C.toLocaleDateString(void 0,{month:"short",day:"numeric"}),accuracy:p.total>0?Math.round(p.correct/p.total*100):0,total:p.total}})},[w,v]),K=()=>$(!0),U=()=>{k(),J("Heat map data has been reset.","success")};return e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h1",{className:"type-display",children:"Progress"}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Z,{icon:re,label:"Total Answers",value:x.total}),e.jsx(Z,{icon:ce,label:"Accuracy",value:`${x.accuracy}%`,tone:x.accuracy>=75?"success":x.accuracy>=50?"warning":"danger"}),e.jsx(Z,{icon:qe,label:"Coverage",value:`${x.coverage}%`,tone:x.coverage>=70?"success":x.coverage>=40?"warning":"danger"}),e.jsx(Z,{icon:ge,label:"Streak",value:`${F}d • ${N} freeze`})]})]}),e.jsxs(P,{children:[e.jsxs(M,{className:"flex flex-row items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-xl",children:"Your Fretboard"}),e.jsxs(A,{children:[x.positionsPracticed," positions practiced • ",x.coverage,"% coverage"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:a,className:Q(y&&"border-primary/40 bg-primary/10"),children:[y?"Hide":"Show"," Heat Map"]}),e.jsx(m,{variant:"ghost",size:"sm",onClick:K,className:"text-destructive hover:text-destructive",children:e.jsx(ne,{className:"h-4 w-4"})})]})]}),e.jsxs(D,{className:"space-y-4",children:[x.positionsPracticed===0&&e.jsx(ue,{title:"Your fretboard map is empty",description:"Each note you practice lights up here. Start a short session to begin.",ctaLabel:"Start Practice",onCtaClick:()=>c("/practice",{state:{openPreFlight:!0,source:"progress-heatmap-empty",mode:"fretboardToNote"}})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{className:"h-3 w-3 rounded-full bg-rose-500/50"}),"weak ","<"," 60%"]}),e.jsxs("div",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{className:"h-3 w-3 rounded-full bg-amber-400/60"}),"learning 60-85%"]}),e.jsxs("div",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{className:"h-3 w-3 rounded-full bg-emerald-500/50"}),"mastered ",">"," 85%"]})]}),e.jsx("div",{className:"rounded-xl border border-border bg-card/50 p-4",children:e.jsx(_e,{frets:12,activeNotes:te,tuning:r,leftHanded:B,className:"max-w-full",fitContainer:!0})})]})]}),e.jsxs(P,{children:[e.jsx(M,{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-xl",children:"Accuracy Trend"}),e.jsx(A,{children:"Track consistency over time"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{size:"sm",variant:v==="week"?"secondary":"outline",onClick:()=>z("week"),children:"Week"}),e.jsx(m,{size:"sm",variant:v==="month"?"secondary":"outline",onClick:()=>z("month"),children:"Month"}),e.jsx(m,{size:"sm",variant:v==="all"?"secondary":"outline",onClick:()=>z("all"),children:"All"})]})]})}),e.jsx(D,{children:e.jsx(cs,{data:j})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(P,{children:[e.jsxs(M,{children:[e.jsx(S,{className:"text-xl",children:"Focus Areas"}),e.jsx(A,{children:"Positions with the lowest retention"})]}),e.jsx(D,{children:x.weakPositions.length===0?e.jsx(ue,{title:"No focus areas yet",description:"Complete a few sessions to identify weak spots.",ctaLabel:"Open Train",onCtaClick:()=>c("/train")}):e.jsxs("div",{className:"space-y-3",children:[x.weakPositions.map(([n,o])=>{const[l,p]=n.split("-").map(Number),C=Math.round(o.correct/o.total*100);return e.jsx("div",{className:"rounded-lg border border-border bg-card p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium",children:["String ",l+1,", fret ",p]}),e.jsxs("span",{className:Q("font-mono",C>=75?"text-emerald-600 dark:text-emerald-400":C>=50?"text-amber-600 dark:text-amber-400":"text-rose-600 dark:text-rose-400"),children:[C,"%"]})]})},n)}),e.jsx(m,{variant:"outline",className:"w-full",onClick:()=>c("/practice",{state:{openPreFlight:!0,source:"progress-focus-spots",mode:"fretboardToNote"}}),children:"Practice Weak Spots"})]})})]}),e.jsxs(P,{children:[e.jsxs(M,{children:[e.jsx(S,{className:"text-xl",children:"Achievements"}),e.jsxs(A,{children:[s.length," / ",u.length," unlocked"]})]}),e.jsx(D,{children:e.jsx("div",{className:"space-y-2",children:u.map(n=>{const o=is[n.id]??fe;return e.jsxs("div",{className:Q("flex items-center gap-3 rounded-lg border p-3",n.unlockedAt?"border-emerald-300 bg-emerald-50 dark:border-emerald-500/30 dark:bg-emerald-500/10":"border-border bg-muted/40 opacity-70"),children:[e.jsx("div",{className:"rounded-full bg-background p-2 text-muted-foreground",children:e.jsx(o,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"truncate font-medium",children:n.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n.description})]})]},n.id)})})})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Practice time: ",Math.floor(g/60),"h ",g%60,"m"]}),e.jsx(je,{open:H,onOpenChange:$,title:"Reset Heat Map Data?",description:"This will remove all heat map entries.",confirmLabel:"Reset",confirmVariant:"destructive",onConfirm:U})]})}function os(c,t=new Date){return{app:"FretMemo",schemaVersion:1,exportedAt:t.toISOString(),progress:{positionStats:c.positionStats,heatMapEnabled:c.heatMapEnabled,totalPracticeTime:c.totalPracticeTime,streakDays:c.streakDays,streakFreezes:c.streakFreezes,lastFreezeDate:c.lastFreezeDate,lastPracticeDate:c.lastPracticeDate,totalCorrect:c.totalCorrect,totalIncorrect:c.totalIncorrect,sessionHistory:c.sessionHistory,achievements:c.achievements}}}function ds(c=new Date){return`fretmemo-progress-${c.toISOString().replace(/[:.]/g,"-")}.json`}function ms(c){if(typeof window>"u"||typeof document>"u")throw new Error("Download is only available in browser environments.");const t=new Date,y=os(c,t),a=new Blob([JSON.stringify(y,null,2)],{type:"application/json"}),k=window.URL.createObjectURL(a),g=document.createElement("a");g.href=k,g.download=ds(t),document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(k)}async function us(c){const t=await c.text();return JSON.parse(t)}function hs(){const c=q(s=>s.quick),t=q(s=>s.full),y=q(s=>s.updateQuickSettings),a=q(s=>s.updateFullSettings),k=q(s=>s.resetSettings),g=G(s=>s.importProgressData),F=G(s=>s.resetProgressData),N=xe(s=>s.enqueue),R=T.useRef(null),L=T.useRef("merge"),[u,h]=T.useState(null),w=(s,j="info")=>{N(s,j)},B=s=>{L.current=s,R.current?.click()},W=()=>{h("reset-settings")},r=()=>{try{ms(G.getState()),w("Progress data exported.","success")}catch(s){console.error("Failed to export progress data",s),w("Could not export progress data. Please try again.","error")}},i=s=>{if(s==="replace"){h("replace-progress-import");return}B(s)},f=async s=>{const j=s.currentTarget,K=j.files?.[0];if(K)try{const U=await us(K),n=g(U,L.current);w(n.message,n.success?"success":"error")}catch(U){console.error("Failed to import progress data",U),w("Could not import progress data. Make sure the file is valid JSON.","error")}finally{j.value=""}},d=()=>{h("reset-progress")},H=()=>{if(u==="reset-settings"){k(),w("Settings reset to defaults.","success");return}if(u==="replace-progress-import"){B("replace");return}u==="reset-progress"&&(F(),w("All progress data has been reset.","success"))},$=u==="reset-settings"?{title:"Reset Settings?",description:"This restores all app settings to defaults. Progress data will not be changed.",confirmLabel:"Reset Settings",confirmVariant:"destructive"}:u==="replace-progress-import"?{title:"Replace Progress Data?",description:"This will overwrite your current progress with imported data.",confirmLabel:"Replace",confirmVariant:"destructive"}:u==="reset-progress"?{title:"Reset All Progress Data?",description:"This removes practice stats, session history, and unlocked achievements.",confirmLabel:"Reset Progress",confirmVariant:"destructive"}:null,_=!!$,v=he(c.tuning),z=le(t.instrument.type),J=Ne(z),x=(()=>{const s=be(v);return J.some(j=>j.id===s)?s:"custom"})(),ee=oe[z],se=v.slice().reverse().join("-"),te=s=>{s||h(null)};return e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your preferences and configuration."})]}),e.jsxs(m,{variant:"outline",onClick:W,className:"text-destructive hover:text-destructive",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Reset Defaults"]})]}),e.jsx(V,{title:"Instrument",summary:`${ee} · ${v.length} strings`,defaultOpen:!0,children:e.jsxs(P,{children:[e.jsxs(M,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5"}),"Instrument"]}),e.jsx(A,{children:"Configure instrument family, tuning, and handedness."})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{htmlFor:"instrument-type",children:"Instrument Type"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Changes available tuning presets and string count."})]}),e.jsx("select",{id:"instrument-type",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",value:z,onChange:s=>{const j=le(s.target.value);a({instrument:{...t.instrument,type:j}}),y({tuning:ke(j)})},children:Object.entries(oe).map(([s,j])=>e.jsx("option",{value:s,children:j},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{htmlFor:"tuning-preset",children:"Tuning Preset"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Applies to all fretboard-based exercises."})]}),e.jsxs("select",{id:"tuning-preset",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",value:x,onChange:s=>{const j=s.target.value;j!=="custom"&&y({tuning:we(j)})},children:[J.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id)),e.jsx("option",{value:"custom",children:"Custom (Current)"})]}),e.jsxs("p",{className:"text-xs font-mono text-muted-foreground",children:["Active tuning (",v.length," strings): ",se]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{children:"Left-Handed Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mirror the fretboard for left-handed playing."})]}),e.jsx(E,{checked:t.instrument.leftHanded,onCheckedChange:s=>a({instrument:{...t.instrument,leftHanded:s}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{children:"Show Fret Numbers"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Display numbers on the fretboard visualization."})]}),e.jsx(E,{checked:t.instrument.showFretNumbers,onCheckedChange:s=>a({instrument:{...t.instrument,showFretNumbers:s}})})]})]})]})}),e.jsx(V,{title:"Practice",summary:`${c.tempo} BPM · ${t.learning.autoAdvance?"Auto-Advance On":"Auto-Advance Off"}`,defaultOpen:!0,children:e.jsxs(P,{children:[e.jsxs(M,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"Learning Behavior"]}),e.jsx(A,{children:"Adjust how the application helps you learn."})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{children:"Auto-Advance"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically move to the next question after a correct answer."})]}),e.jsx(E,{checked:t.learning.autoAdvance,onCheckedChange:s=>a({learning:{...t.learning,autoAdvance:s}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{children:"Show Hints"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Display markers or helpers when stuck."})]}),e.jsx(E,{checked:t.learning.showHints,onCheckedChange:s=>a({learning:{...t.learning,showHints:s}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{children:"Spaced Repetition"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Prioritize weak areas and older items."})]}),e.jsx(E,{checked:t.learning.spacedRepetition,onCheckedChange:s=>a({learning:{...t.learning,spacedRepetition:s}})})]})]})]})}),e.jsx(V,{title:"Audio",summary:`Volume ${Math.round(t.audio.volume*100)}% · ±${t.audio.pitchTolerance} cents`,children:e.jsxs(P,{children:[e.jsxs(M,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-5 w-5"}),"Audio & Input"]}),e.jsx(A,{children:"Manage sound output and microphone input."})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(b,{children:"Master Volume"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(t.audio.volume*100),"%"]})]}),e.jsx(me,{value:[t.audio.volume*100],min:0,max:100,step:1,onValueChange:s=>a({audio:{...t.audio,volume:s[0]/100}})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(b,{children:"Pitch Tolerance (cents)"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["±",t.audio.pitchTolerance]})]}),e.jsx(me,{value:[t.audio.pitchTolerance],min:5,max:50,step:1,onValueChange:s=>a({audio:{...t.audio,pitchTolerance:s[0]}})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Higher values make detection more forgiving."})]})]})]})}),e.jsx(V,{title:"Appearance",summary:`${t.display.theme==="dark"?"Dark":t.display.theme==="light"?"Light":"System"} · ${t.display.defaultLayer}`,children:e.jsxs(P,{children:[e.jsxs(M,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-5 w-5"}),"Appearance & Interface"]}),e.jsx(A,{children:"Customize how FretMemo looks and feels."})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{children:"Theme"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose light, dark, or follow your device preference."})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{id:"light",label:"Light"},{id:"dark",label:"Dark"},{id:"system",label:"System"}].map(s=>e.jsx(m,{type:"button",size:"sm",variant:t.display.theme===s.id?"secondary":"outline",onClick:()=>a({display:{...t.display,theme:s.id}}),children:s.label},s.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{children:"Default Fretboard Layer"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Used as the starting layer in Focus Mode."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-4",children:[{id:"standard",label:"Standard"},{id:"heatmap",label:"Heatmap"},{id:"scale",label:"Scale"},{id:"intervals",label:"Intervals"}].map(s=>e.jsx(m,{type:"button",size:"sm",variant:t.display.defaultLayer===s.id?"secondary":"outline",onClick:()=>a({display:{...t.display,defaultLayer:s.id}}),children:s.label},s.id))})]})]})]})}),e.jsx(V,{title:"Game",summary:`${t.gamification.showXPNotes?"XP Notes On":"XP Notes Off"} · ${t.gamification.showStreakWarnings?"Warnings On":"Warnings Off"}`,children:e.jsxs(P,{children:[e.jsxs(M,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),"Gamification"]}),e.jsx(A,{children:"Manage XP, streaks, and rewards."})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{children:"Show XP Animations"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show floating XP summaries after answers."})]}),e.jsx(E,{checked:t.gamification.showXPNotes,onCheckedChange:s=>a({gamification:{...t.gamification,showXPNotes:s}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{children:"Streak Warnings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Alert when streak is at risk of breaking."})]}),e.jsx(E,{checked:t.gamification.showStreakWarnings,onCheckedChange:s=>a({gamification:{...t.gamification,showStreakWarnings:s}})})]}),e.jsx("div",{className:"rounded-lg border border-border bg-muted/30 p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("span",{className:"text-sm font-medium",children:"Streak Freezes"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Protect your streak if you miss a day."})]}),e.jsx("span",{className:"text-lg font-bold text-primary tabular-nums",children:G.getState().streakFreezes})]})})]})]})}),e.jsxs(V,{title:"Data",summary:"Export · Import · Reset",children:[e.jsxs(P,{children:[e.jsxs(M,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5"}),"Progress Backup"]}),e.jsx(A,{children:"Export your practice data to JSON and import it later."})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsx("input",{ref:R,type:"file",accept:".json,application/json",className:"hidden",onChange:f}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-3",children:[e.jsx(m,{variant:"outline",onClick:r,children:"Export Progress"}),e.jsx(m,{variant:"outline",onClick:()=>i("merge"),children:"Import (Merge)"}),e.jsx(m,{variant:"outline",onClick:()=>i("replace"),children:"Import (Replace)"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Merge keeps current progress and adds imported data. Replace overwrites all current progress."})]})]}),e.jsxs(P,{className:"border-destructive/30",children:[e.jsxs(M,{children:[e.jsxs(S,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(ne,{className:"h-5 w-5"}),"Danger Zone"]}),e.jsx(A,{children:"Permanent actions affecting your learning history."})]}),e.jsx(D,{children:e.jsx(m,{variant:"destructive",onClick:d,children:"Reset All Progress Data"})})]})]}),e.jsx(V,{title:"Help",summary:"FAQ · Blog · Contact",children:e.jsxs(P,{children:[e.jsxs(M,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5"}),"Help & Support"]}),e.jsx(A,{children:"Quick access to FAQ, updates, and support."})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2 sm:grid-cols-3",children:[e.jsx(m,{asChild:!0,variant:"outline",className:"justify-between",children:e.jsxs("a",{href:Y.faq,target:"_blank",rel:"noreferrer noopener",children:[e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),"FAQ"]}),e.jsx(ae,{className:"h-3.5 w-3.5"})]})}),e.jsx(m,{asChild:!0,variant:"outline",className:"justify-between",children:e.jsxs("a",{href:Y.blog,target:"_blank",rel:"noreferrer noopener",children:[e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),"Blog"]}),e.jsx(ae,{className:"h-3.5 w-3.5"})]})}),e.jsx(m,{asChild:!0,variant:"outline",className:"justify-between",children:e.jsxs("a",{href:Y.contactMailto,children:[e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"Contact"]}),e.jsx(ae,{className:"h-3.5 w-3.5"})]})})]}),e.jsx(m,{asChild:!0,className:"control-btn--primary justify-start",children:e.jsxs("a",{href:Y.buyMeCoffee,target:"_blank",rel:"noreferrer noopener",children:[e.jsx(Se,{className:"h-4 w-4"}),"Buy me a coffee"]})})]})]})}),$&&e.jsx(je,{open:_,onOpenChange:te,title:$.title,description:$.description,confirmLabel:$.confirmLabel,confirmVariant:$.confirmVariant,onConfirm:H})]})}function ks(){const[c,t]=pe(),a=c.get("section")==="settings"?"settings":"progress",k=F=>{const N=new URLSearchParams(c);N.set("section",F),t(N,{replace:!0})},g=T.useMemo(()=>a==="settings"?e.jsx(hs,{}):e.jsx(ls,{}),[a]);return e.jsxs("div",{className:"space-y-4 pb-8",children:[e.jsx("div",{className:"sticky top-0 z-20 border-b border-border/50 bg-background/95 py-2 backdrop-blur",children:e.jsx(Re,{value:a,onValueChange:F=>k(F),className:"w-full",children:e.jsxs(He,{className:"grid w-full max-w-sm grid-cols-2",children:[e.jsx(de,{value:"progress",children:"Progress"}),e.jsx(de,{value:"settings",children:"Settings"})]})})}),g]})}export{ks as default};
